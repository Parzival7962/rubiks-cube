<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Rubik's Cube</title>
        <style>
            body {
                
                background-color:black;
                color:white;
                font-family:sans-serif;
                font-size: 15px;
            }
            img {
                width:800px;
                
            }
            h1 {
                font-size: 4em;
                font-weight:bold;
                
            }
            h2{
                font-size: 2em;
                font-weight:bold;
            }
            p {
                font-style:normal;
                font-weight:normal;
            }
          
        </style>
        
    </head>
    <body>
        
        
         <canvas id="mycanvas"></canvas> 
          <!-- Include the processing.js library -->
        <!-- See https://khanacademy.zendesk.com/hc/en-us/articles/202260404-What-parts-of-ProcessingJS-does-Khan-Academy-support- for differences -->
        <script src="https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js"></script>
        <script>
            

/*
Working net of a rubik's cube in javascript
press ' to repeat the last move twice (for counterclockwise turns)

q: white
w: orange
e: yellow
a: green
s: red
d: blue

`(left of 1 key): scramble

*/
var programCode = function(processingInstance) {
            with (processingInstance) {
                size(400, 400); 
                frameRate(60);
                
                textAlign(CENTER, CENTER);
                rectMode(CENTER);


var cube_accesses = ["top", "middle", "bottom"];
var cube_access;
var prev_key_pressed;
var is_scrambled = false;
var timer = -30;
var timer_started = false;
var prev_second;

//positions, if true statement for collapse
if(true){
var positions = [[[[180,120],[180,80],[140,120]],
                [[200,120],[200,80]],
                [[220,120],[220,80],[260,120]],
                
                [[180,140],[140,140]],
                [[200,140]],
                [[220,140],[260,140]],
                
                [[180,160],[180,200],[140,160]],
                [[200,160],[200,200]],
                [[220,160],[220,200],[260,160]]],
                
                [[[120,120],[180,60]],
                [[200,60]],
                [[280,120],[220,60]],
                
                [[120,140]],
                [[]],
                [[280,140]],
                
                [[120,160],[180,220]],
                [[200,220]],
                [[280,160],[220,220]]],
                
                [[[180,320],[180,40],[100,120]],
                [[200,320],[200,40]],
                [[220,320],[220,40],[300,120]],
                
                [[180,300],[100,140]],
                [[200,300]],
                [[220,300],[300,140]],
                
                [[180,280],[180,240],[100,160]],
                [[200,280],[200,240]],
                [[220,280],[220,240],[300,160]]]];}

var cube = {
    "top": [["w","o","g"],["w","o"],["w","o","b"],
            ["w","g"],    ["w"],    ["w","b"],
            ["w","r","g"],["w","r"],["w","r","b"]],
    "middle": [["g","o"],["o"],["b","o"],
               ["g"],    [],   ["b"],
               ["g","r"],["r"],["b","r"]],
    "bottom": [["y","o","g"],["y","o"],["y","o","b"],
               ["y","g"],    ["y"],    ["y","b"],
               ["y","r","g"],["y","r"],["y","r","b"]]
};

function turnBlue() {
    
    var tempPiece;
    
    tempPiece = cube.top[2];
    cube.top[2] = cube.top[8];
    cube.top[8] = cube.bottom[8];
    cube.bottom[8] = cube.bottom[2];
    cube.bottom[2] = tempPiece;

    tempPiece = cube.top[5];
    cube.top[5] = cube.middle[8];
    cube.middle[8] = cube.bottom[5];
    cube.bottom[5] = cube.middle[2];
    cube.middle[2] = tempPiece;
    
    var pieces = [["top", 2], ["top",8], ["bottom",8], ["bottom",2], ["top",5],["middle", 8], ["bottom",5], ["middle", 2]];
    
    
    for(var i=0; i < pieces.length; i++){
        var acc_1 = cube[pieces[i][0]][pieces[i][1]].shift();
        var acc_2 = cube[pieces[i][0]][pieces[i][1]].shift();
        cube[pieces[i][0]][pieces[i][1]].unshift(acc_1);
        cube[pieces[i][0]][pieces[i][1]].unshift(acc_2);
        
    }
}

function turnGreen() {
    var tempPiece;

    tempPiece = cube.bottom[0];
    cube.bottom[0] = cube.bottom[6];
    cube.bottom[6] = cube.top[6];
    cube.top[6] = cube.top[0];
    cube.top[0] = tempPiece;

    
    tempPiece = cube.top[3];
    cube.top[3] = cube.middle[0];
    cube.middle[0] = cube.bottom[3];
    cube.bottom[3] = cube.middle[6];
    cube.middle[6] = tempPiece;
    
    var pieces = [["bottom", 0], ["bottom",6], ["top",6], ["top",0], ["top",3],["middle", 0], ["bottom",3], ["middle", 6]];
    
    
    for(var i=0; i < pieces.length; i++){
        var acc_1 = cube[pieces[i][0]][pieces[i][1]].shift();
        var acc_2 = cube[pieces[i][0]][pieces[i][1]].shift();
        cube[pieces[i][0]][pieces[i][1]].unshift(acc_1);
        cube[pieces[i][0]][pieces[i][1]].unshift(acc_2);
    }
}

function turnRed() {
    var tempPiece;

    tempPiece = cube.bottom[6];
    cube.bottom[6] = cube.bottom[8];
    cube.bottom[8] = cube.top[8];
    cube.top[8] = cube.top[6];
    cube.top[6] = tempPiece;

    
    tempPiece = cube.top[7];
    cube.top[7] = cube.middle[6];
    cube.middle[6] = cube.bottom[7];
    cube.bottom[7] = cube.middle[8];
    cube.middle[8] = tempPiece;
    
    var pieces = [["bottom", 6], ["bottom",8], ["top",8], ["top",6], ["top",7],["middle", 6], ["bottom",7], ["middle", 8]];
    
    
    for(var i=0; i < pieces.length; i++){
        if(cube[pieces[i][0]][pieces[i][1]].length === 3){
        var acc_1 = cube[pieces[i][0]][pieces[i][1]].shift();
        var acc_2 = cube[pieces[i][0]][pieces[i][1]].pop();
        cube[pieces[i][0]][pieces[i][1]].push(acc_1);
        cube[pieces[i][0]][pieces[i][1]].unshift(acc_2);
        }
    }
}

function turnOrange() {
    var tempPiece;

    tempPiece = cube.top[0];
    cube.top[0] = cube.top[2];
    cube.top[2] = cube.bottom[2];
    cube.bottom[2] = cube.bottom[0];
    cube.bottom[0] = tempPiece;

    
    tempPiece = cube.top[1];
    cube.top[1] = cube.middle[2];
    cube.middle[2] = cube.bottom[1];
    cube.bottom[1] = cube.middle[0];
    cube.middle[0] = tempPiece;
    
    var pieces = [["bottom", 0], ["bottom",2], ["top",2], ["top",0], ["top",1],["middle", 0], ["bottom",1], ["middle", 2]];
    
    
    for(var i=0; i < pieces.length; i++){
        if(cube[pieces[i][0]][pieces[i][1]].length === 3){
        var acc_1 = cube[pieces[i][0]][pieces[i][1]].shift();
        var acc_2 = cube[pieces[i][0]][pieces[i][1]].pop();
        cube[pieces[i][0]][pieces[i][1]].push(acc_1);
        cube[pieces[i][0]][pieces[i][1]].unshift(acc_2);
        }
    }
}

function turnWhite() {
    var tempPiece;

    tempPiece = cube.top[0];
    cube.top[0] = cube.top[6];
    cube.top[6] = cube.top[8];
    cube.top[8] = cube.top[2];
    cube.top[2] = tempPiece;

    tempPiece = cube.top[1];
    cube.top[1] = cube.top[3];
    cube.top[3] = cube.top[7];
    cube.top[7] = cube.top[5];
    cube.top[5] = tempPiece;
    
    var pieces = [0,6,8,2,1,3,7,5];
    
    for(var i=0; i < pieces.length; i++){
        if(cube.top[pieces[i]].length === 3){
        var acc_1 = cube.top[pieces[i]].pop();
        var acc_2 = cube.top[pieces[i]].pop();
        cube.top[pieces[i]].push(acc_1);
        cube.top[pieces[i]].push(acc_2);
        }
    }
}

function turnYellow() {
    var tempPiece;
    
    tempPiece = cube.bottom[0];
    cube.bottom[0] = cube.bottom[2];
    cube.bottom[2] = cube.bottom[8];
    cube.bottom[8] = cube.bottom[6];
    cube.bottom[6] = tempPiece;
    
    tempPiece = cube.bottom[1];
    cube.bottom[1] = cube.bottom[5];
    cube.bottom[5] = cube.bottom[7];
    cube.bottom[7] = cube.bottom[3];
    cube.bottom[3] = tempPiece;
    
    var pieces = [0,2,8,6,1,5,7,3];
    
    for(var i=0; i < pieces.length; i++){
        if(cube.bottom[pieces[i]].length === 3){
        var acc_1 = cube.bottom[pieces[i]].pop();
        var acc_2 = cube.bottom[pieces[i]].pop();
        cube.bottom[pieces[i]].push(acc_1);
        cube.bottom[pieces[i]].push(acc_2);
        }
    }
    
}

function scramble() {
    var total_turns = floor(random(20, 30));
    var turns = [turnBlue,turnGreen,turnRed,turnOrange,turnWhite,turnYellow];
    
    timer_started = !timer_started;
    
    if(!is_scrambled){
        for(var i = 0; i < total_turns; i++){
            var select = floor(random(0,turns.length));
            
            turns[select]();
            
        }
    }
    else{
        cube = {
            "top": [["w","o","g"],["w","o"],["w","o","b"],
                    ["w","g"],    ["w"],    ["w","b"],
                    ["w","r","g"],["w","r"],["w","r","b"]],
            "middle": [["g","o"],["o"],["b","o"],
                       ["g"],    [],   ["b"],
                       ["g","r"],["r"],["b","r"]],
            "bottom": [["y","o","g"],["y","o"],["y","o","b"],
                       ["y","g"],    ["y"],    ["y","b"],
                       ["y","r","g"],["y","r"],["y","r","b"]]
};
    }
    
    is_scrambled = !is_scrambled;
    
}

draw = function() {
    var current_second = second();
    background(0, 0, 0);
    fill(255, 0, 0);
    text(timer, 100, 300);
    if(timer_started){
        if (current_second !== prev_second){
            timer++;
        }
        prev_second = current_second;
    }
    
    
    
    for(var j = 0;j < 3; j++){
        cube_access = cube_accesses[j];
        for(var l = 0;l<9;l++){
            for(var i = 0;i<cube[cube_access][l].length;i++){
                if(cube[cube_access][l][i] === "o"){
                    fill(255, 162, 0);
                }
                else if(cube[cube_access][l][i] === "b"){
                    fill(0, 0, 255);
                }
                else if(cube[cube_access][l][i] === "w"){
                    fill(255, 255, 255);
                }
                else if(cube[cube_access][l][i] === "g"){
                    fill(0, 255, 0);
                }
                else if(cube[cube_access][l][i] === "r"){
                    fill(255, 0, 0);
                }
                else if(cube[cube_access][l][i] === "y"){
                    fill(213, 255, 0);
                }
                text(cube[cube_access][l][i], positions[j][l][i][0], positions[j][l][i][1]);
            }
        }
    }
};

keyPressed = function(){
    var turns = {
        "q": turnWhite,
        "e": turnYellow,
        "a": turnGreen,
        "d": turnBlue,
        "s": turnRed,
        "w": turnOrange,
        "`": scramble
    };
    
    var key_last_pressed = key.toString();
    
    if(key_last_pressed === " "){
        timer_started = !timer_started;
    }
    
    
    if((timer >= 0 && timer_started) || (!timer_started && timer === -30)){
        if(key_last_pressed in turns){
            turns[key_last_pressed]();
            prev_key_pressed = key_last_pressed;
        }
        else if(key_last_pressed === "'"){
            if(prev_key_pressed in turns){
                turns[prev_key_pressed]();
                turns[prev_key_pressed]();
            }
        }
        
    }
};
            }}
              // Get the canvas that ProcessingJS will use
        var canvas = document.getElementById("mycanvas"); 
        // Pass the function to ProcessingJS constructor
        var processingInstance = new Processing(canvas, programCode); 
            
        </script>
        </body>
</html>
